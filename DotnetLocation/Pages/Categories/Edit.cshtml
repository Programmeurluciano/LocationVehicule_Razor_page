@page
@model DotnetLocation.Pages.Categories.EditModel

@{
    ViewData["Title"] = "Modifier la Catégorie";
}

<div class="title-wrapper pt-30">
    <div class="row align-items-center">
        <div class="col-md-6">
            <div class="title">
                <h2>Modifier la Catégorie</h2>
            </div>
        </div>
        <!-- end col -->
        <div class="col-md-6">
            <div class="breadcrumb-wrapper">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">
                            <a href="/">
                                Tableau de bord
                            </a>
                        </li>
                        <li class="breadcrumb-item">
                            <a asp-page="Index">Catégories</a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page">
                            Modification
                        </li>
                    </ol>
                </nav>
            </div>
        </div>
        <!-- end col -->
    </div>
    <!-- end row -->
</div>
<!-- ========== title-wrapper end ========== -->

<div class="tables-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <div class="card-style mb-30">
                <h6 class="mb-3">Formulaire de modification</h6>
                <p class="text-sm mb-20">
                    Modifiez les informations de la catégorie ci-dessous.
                </p>

                <div class="row">
                    <div class="col-md-12">
                        <form method="post">
                            <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>
                            <input type="hidden" asp-for="Categorie.Id" />

                            <div class="form-group mb-3">
                                <label asp-for="Categorie.Nom" class="form-label fw-500">
                                    Nom de la catégorie <span class="text-danger">*</span>
                                </label>
                                <input asp-for="Categorie.Nom" class="form-control" aria-required="true"
                                       placeholder="Entrez le nom de la catégorie" />
                                <span asp-validation-for="Categorie.Nom" class="text-danger text-sm"></span>
                            </div>

                            <div class="form-group mb-4">
                                <label asp-for="Categorie.Description" class="form-label fw-500">
                                    Description
                                </label>
                                <textarea asp-for="Categorie.Description" class="form-control" rows="4"
                                          placeholder="Décrivez brièvement cette catégorie"></textarea>
                                <span asp-validation-for="Categorie.Description" class="text-danger text-sm"></span>
                            </div>

                            <div class="d-flex justify-content-between align-items-center mt-4 pt-3 border-top">
                                <a asp-page="Index" class="main-btn light-btn btn-hover">
                                    <i class="lni lni-arrow-left me-2"></i> Retour à la liste
                                </a>
                                <div>
                                    <a asp-page="./Details" asp-route-id="@Model.Categorie.Id" class="main-btn info-btn btn-hover me-2">
                                        <i class="lni lni-eye me-2"></i> Détails
                                    </a>
                                    <button type="submit" class="main-btn success-btn btn-hover">
                                        <i class="lni lni-checkmark-circle me-2"></i> Enregistrer
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!-- end card -->
        </div>
        <!-- end col -->
    </div>
    <!-- end row -->
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Focus sur le champ nom
            document.getElementById('Categorie_Nom').focus();

            // Confirmation avant annulation
            const cancelBtn = document.querySelector('a[href*="Index"]');
            if (cancelBtn) {
                cancelBtn.addEventListener('click', function(e) {
                    const nomInput = document.getElementById('Categorie_Nom');
                    const descInput = document.getElementById('Categorie_Description');

                    if (nomInput.value.trim() !== '@Model.Categorie.Nom' ||
                        descInput.value.trim() !== '@Model.Categorie.Description') {
                        if (!confirm('Vous avez des modifications non enregistrées. Voulez-vous vraiment quitter ?')) {
                            e.preventDefault();
                        }
                    }
                });
            }
        });
    </script>
}